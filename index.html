<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apple Wallet Clone</title>
    <style>
        /* Add this new CSS */
        .card {
            transition: all 0.4s cubic-bezier(0.4,0,0.2,1), opacity 0.3s ease;
            will-change: transform, opacity;
        }

        .card.active {
            position: fixed;
            top: 151px !important; /* 4cm â‰ˆ 151px */
            left: 50% !important;
            transform: translate(-50%, 0) !important;
            z-index: 1000;
            max-width: 95%;
            width: 90%;
        }
    </style>
</head>
<body>
    <!-- Previous HTML remains the same -->

    <script>
        // Modified card click handler
        function createCard(imageSrc, isLoyalty, fromStorage = false) {
            // ... existing code ...

            card.addEventListener('click', function() {
                const doneBtn = document.getElementById('done-btn');
                
                // Store original position
                const originalRect = this.getBoundingClientRect();
                this.style.position = 'fixed';
                this.style.width = `${originalRect.width}px`;
                this.style.height = `${originalRect.height}px`;
                this.style.left = `${originalRect.left}px`;
                this.style.top = `${originalRect.top}px`;

                // Trigger reflow
                void this.offsetWidth;

                // Animate to final position
                this.classList.add('active');
                this.style.width = '90%';
                this.style.left = '50%';
                this.style.top = '151px'; // 4cm below done button
                this.style.transform = 'translateX(-50%)';

                // Hide other elements
                document.querySelectorAll('.card:not(.active)').forEach(c => {
                    c.style.opacity = '0';
                    c.style.pointerEvents = 'none';
                });
                document.querySelector('header').classList.add('header-hidden');
                doneBtn.classList.add('visible');
            });

            // ... rest of createCard function ...
        }

        // Modified done button handler
        document.getElementById('done-btn').addEventListener('click', function() {
            const activeCard = document.querySelector('.card.active');
            if (activeCard) {
                // Store current position
                const currentRect = activeCard.getBoundingClientRect();
                
                // Animate back to original position
                activeCard.style.width = `${activeCard.originalWidth}px`;
                activeCard.style.height = `${activeCard.originalHeight}px`;
                activeCard.style.left = `${activeCard.originalLeft}px`;
                activeCard.style.top = `${activeCard.originalTop}px`;

                setTimeout(() => {
                    activeCard.classList.remove('active');
                    activeCard.style.cssText = ''; // Reset inline styles
                }, 400);

                // Show other elements
                document.querySelectorAll('.card').forEach(c => {
                    c.style.opacity = '1';
                    c.style.pointerEvents = 'auto';
                });
                document.querySelector('header').classList.remove('header-hidden');
                this.classList.remove('visible');
            }
        });
    </script>
</body>
</html>
